<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>AJAX编程.md</title><link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css'><style type='text/css'>html, body {overflow-x: initial !important;}.CodeMirror { height: auto; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; }
.CodeMirror-lines { padding: 4px 0px; }
.CodeMirror pre { }
.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { background-color: white; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background-color: rgb(247, 247, 247); white-space: nowrap; }
.CodeMirror-linenumbers { }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.CodeMirror div.CodeMirror-cursor { border-left: 1px solid black; z-index: 3; }
.CodeMirror div.CodeMirror-secondarycursor { border-left: 1px solid silver; }
.CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor { width: auto; border: 0px; background: rgb(119, 238, 119); z-index: 1; }
.CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite { }
.cm-tab { display: inline-block; }
.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property { color: rgb(217, 79, 138); }
.cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) { font-size: 2rem; line-height: 2rem; }
.cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) { font-size: 1.4rem; line-height: 1.4rem; }
.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number { color: rgb(149, 132, 134); }
.cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start { font-family: monospace; }
.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code { color: rgb(74, 90, 159); font-family: monospace; }
.cm-s-typora-default .cm-tag { color: rgb(169, 68, 66); }
.cm-s-typora-default .cm-string { color: rgb(126, 134, 169); }
.cm-s-typora-default .cm-link { color: rgb(196, 122, 15); text-decoration: underline; }
.cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 { color: inherit; }
.cm-s-typora-default .cm-overlay { font-size: 1rem; font-family: monospace; }
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor { border-left: 3px solid rgb(228, 98, 154); }
.cm-s-typora-default .CodeMirror-activeline-background { left: -60px; right: -30px; background: rgba(204, 204, 204, 0.2); }
.cm-s-typora-default .CodeMirror-gutters { border-right: none; background-color: inherit; }
.cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after { content: "•"; position: absolute; left: 0px; opacity: 0; font-family: LetterGothicStd, monospace; }
.os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after { left: -0.1em; }
.cm-starttab .cm-tab::after { content: " "; }
.cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line { font-family: monospace; position: relative; }
.cm-s-typora-default .cm-trailing-space-new-line::after { content: "↓"; opacity: 0.3; }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: black; }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-property { color: black; }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: blue; }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: bold; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: rgb(255, 0, 0); }
.cm-invalidchar { color: rgb(255, 0, 0); }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { margin-bottom: -30px; margin-right: -30px; padding-bottom: 30px; padding-right: 30px; height: 100%; outline: none; position: relative; box-sizing: content-box; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow-x: hidden; overflow-y: scroll; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow-y: hidden; overflow-x: scroll; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: transparent; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-widget { }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.CodeMirror-selected { background: rgb(217, 217, 217); }
.CodeMirror-focused .CodeMirror-selected { background: rgb(215, 212, 240); }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
.CodeMirror span { }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}
.CodeMirror-lint-markers { width: 16px; }
.CodeMirror-lint-tooltip { background-color: infobackground; border: 1px solid black; border-radius: 4px; color: infotext; font-family: monospace; overflow: hidden; padding: 2px 5px; position: fixed; white-space: pre-wrap; z-index: 10000; max-width: 600px; opacity: 0; transition: opacity 0.4s; font-size: 0.8em; }
.CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning { background-position: left bottom; background-repeat: repeat-x; }
.CodeMirror-lint-mark-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg=="); }
.CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning { background-position: center center; background-repeat: no-repeat; cursor: pointer; display: inline-block; height: 16px; width: 16px; vertical-align: middle; position: relative; }
.CodeMirror-lint-message-error, .CodeMirror-lint-message-warning { padding-left: 18px; background-position: left top; background-repeat: no-repeat; }
.CodeMirror-lint-marker-error, .CodeMirror-lint-message-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-multiple { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC"); background-repeat: no-repeat; background-position: right bottom; width: 100%; height: 100%; }


html { font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { background: rgb(181, 214, 252); text-shadow: none; }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; overflow-x: auto; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
#write li > table:first-child { margin-top: -20px; }
img { max-width: 100%; vertical-align: middle; }
input, button, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number .md-fences { padding-left: 0px; }
.show-fences-line-number .md-fences.mock-cm { padding-left: 40px; }
.footnotes { opacity: 0.8; font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: transparent; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print { 
  html, body { height: 100%; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { break-after: avoid-page; orphans: 2; }
  p { orphans: 4; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
.md-tag { opacity: 0.5; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: monospace; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-print-anchor { border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; background: transparent !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }


@font-face { font-family: "Open Sans"; font-style: normal; font-weight: normal; src: local("Open Sans Regular"), url("./github/400.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: normal; src: local("Open Sans Italic"), url("./github/400i.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: bold; src: local("Open Sans Bold"), url("./github/700.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: bold; src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff"); }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 20px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
body > :first-child { margin-top: 0px !important; }
body > :last-child { margin-bottom: 0px !important; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 4px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border-width: 0px 0px 1px; border-style: none none solid; border-top-color: initial; border-right-color: initial; border-left-color: initial; border-image: initial; overflow: hidden; box-sizing: content-box; border-bottom-color: rgb(221, 221, 221); }
body > h2:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child + h2 { margin-top: 0px; padding-top: 0px; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child { margin-top: 0px; padding-top: 0px; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 { margin-top: 0px; padding-top: 0px; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p { margin-top: 0px; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; word-break: initial; }
#write { overflow-x: auto; }
table tr { border-top: 1px solid rgb(204, 204, 204); background-color: white; margin: 0px; padding: 0px; }
table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); }
.md-fences, code, tt { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 32px; }
.task-list-item input { top: 3px; left: 8px; }
@media screen and (min-width: 914px) { 
}
@media print { 
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; color: inherit; }
.md-tag { color: inherit; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { background-color: rgb(250, 250, 250); border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; }
#md-notification::before { top: 10px; }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.117647); }
header, .context-menu, .megamenu-content, footer { font-family: "Segoe UI", Arial, sans-serif; }






</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name='header-c1' class='md-header-anchor '></a>HTTP服务&amp;AJAX编程</h1><p>​                <br/></p><h1><a name='header-c8' class='md-header-anchor '></a>第1章 AJAX编程</h1><h2><a name='header-c10' class='md-header-anchor '></a>1.1  Ajax</h2><p>即 Asynchronous Javascript And XML，AJAX 不是一门的新的语言，而是对现有持术的综合利用。</p><pre class='md-fences mock-cm' style='display:block;position:relative'>   	1. 基于web标签的xhtml+css
 	2. 可以使用dom进行动态的显示和交互
 	3. 使用XML和XSLT(是一种用于将XML[文档](https://baike.baidu.com/item/%E6%96%87%E6%A1%A3)转换任意文本的描述语言)进行数据的交换和操作
 	4. 使用XMLHttpRequest进行异步的数据查询和检索等操作。。。</pre><p>本质:是在HTTP协议的基础上以异步的方式通过XMLHttpRequest对象与服务器进行通信。</p><p>作用：可以在页面不刷新的情况下，请求服务器，局部更新页面的数据；</p><h2><a name='header-c18' class='md-header-anchor '></a>1.2  异步（Asynchronous [eɪˈsɪŋkrənəs])</h2><p>指某段程序执行时不会阻塞其它程序执行，其表现形式为程序的执行顺序不依赖程序本身的书写顺序，相反则为同步。 </p><p>其优势在于不阻塞程序的执行，从而提升整体执行效率。</p><p>同步：同一时刻只能做一件事，上一步完成才能开始下一步</p><p>异步：同时做多件事，效率更高</p><p>XMLHttpRequest可以以异步方式的处理程序。</p><h2><a name='header-c29' class='md-header-anchor '></a>1.3  XMLHttpRequest</h2><p>浏览器内建对象，用于在后台与服务器通信(交换数据) ，由此我们便可实现对网页的部分更新，而不是刷新整个页面。</p><p>get方式请求</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">xhr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">XMLHttpRequest</span>();</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置请求行 open (请求方法, 请求url)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//get请求如果有参数就需要在url后面拼接参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//post请求在请求体中传递</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-string">'get'</span>, <span class="cm-string">'index.php?'</span><span class="cm-operator">+</span><span class="cm-variable">name</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置请求头 setRequestHeader('key', 'value')</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//get方式不需要设置请求头</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//post需要设置 Content-Type: application/x-www-form-urlencoded</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置 请求体: 发送请求  send(参数: key=value&amp;key=value)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//如果有参数,post应该在这个位置来传递参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//对于get请求不需要再这个位置来传递参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-atom">null</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//响应报文:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//报文行: 响应状态码 响应状态信息 200 ok</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//报文头: 服务器返回给客户端的一些额外的信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//报文体: 服务器返回给客户端的数据 responseText: 普通字符串 responseXML: 符合xml格式的字符串</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//xhr.status可以获取当前服务器的响应状态</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//一个真正的响应应该两个方面: 1.服务器成功响应 2.数据已经回到客户端并且可以使用了</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//监听异步对象响应状态 readystate</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">onreadystatechange</span> <span class="cm-operator">=</span> <span class="cm-variable">funciton</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">readyState</span> <span class="cm-operator">==</span> <span class="cm-number">4</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">xhr</span>.<span class="cm-property">status</span> <span class="cm-operator">==</span> <span class="cm-number">200</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab"> </span><span class="cm-keyword">var</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelect</span>(<span class="cm-string">'.result'</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">result</span>.<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable">xhr</span>.<span class="cm-property">responseText</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 633px;"></div></div></div></pre><p>post方式请求</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">document</span>.<span class="cm-property">querySelect</span>(<span class="cm-string">"#username"</span>).<span class="cm-property">onblur</span> <span class="cm-operator">=</span> <span class="cm-variable">funciton</span> () {</span></pre></div><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//1.获取用户数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">name</span> <span class="cm-operator">=</span> <span class="cm-keyword">this</span>.<span class="cm-property">value</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  </span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.让异步对象发送post请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.1创建异步对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">xhr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">XMLHttpRequest</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.2设置请求行 open(请求方式, 请求url)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//1.get 需要在url后面拼接参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-tab">   </span><span class="cm-comment">//2.post 不需要拼接参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-string">"post"</span>,<span class="cm-string">"001.php?"</span><span class="cm-operator">+</span><span class="cm-variable">name</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.3设置请求头: setRequestHeader()</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-tab">   </span> <span class="cm-comment">//1.get不需要设置</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab"> </span> <span class="cm-comment">//2.posr需要设置 Content-Type: application/x-www-form-urlencoded</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">xhr</span>.<span class="cm-property">setRequestHeader</span>(<span class="cm-string">"Content-Type"</span>, <span class="cm-string">"application/x-www-form-urlencoded"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.4设置请求体 send()</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//1.get的参数在url中拼接了,所以不需要在这个中设置</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//2.post的参数在这个函数张设置</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">xhr</span>.<span class="cm-property">send</span>(<span class="cm-string">'name=itcast&amp;age=10'</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">  </span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//3.让异步对象接收服务器的响应数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//一个真正的响应应该两个方面: 1.服务器成功响应 2.数据已经回到客户端并且可以使用了</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">xhr</span>.<span class="cm-property">onreadystatechange</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">if</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">status</span> <span class="cm-operator">==</span> <span class="cm-number">4</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">xhr</span>.<span class="cm-property">readyState</span> <span class="cm-operator">==</span> <span class="cm-number">4</span>) {}</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-variable">document</span>.<span class="cm-property">querySelect</span>(<span class="cm-string">".showmsg"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable">xhr</span>.<span class="cm-property">responseText</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 610px;"></div></div></div></pre><p>由于XMLHttpRequest本质基于HTTP协议实现通信，所以结合HTTP协议和上面的例子我们分析得出如下结果：</p><h3><a name='header-c40' class='md-header-anchor '></a>1.3.1   请求</h3><p>HTTP请求3个组成部分与XMLHttpRequest方法的对应关系</p><p>1、请求行</p><p>2、请求头</p><p><strong>get 请求可以不设置 </strong></p><p>3、请求主体</p><p>注意书写顺序</p><h3><a name='header-c53' class='md-header-anchor '></a>1.3.2   响应</h3><p>HTTP响应是由服务端发出的，作为客户端更应关心的是响应的结果。</p><p>HTTP响应3个组成部分与XMLHttpRequest方法或属性的对应关系。</p><p>由于服务器做出响应需要时间（比如网速慢等原因），所以我们需要监听服务器响应的状态，然后才能进行处理。</p><p><strong>onreadystatechange 是   Javascript 的事件的一种，其意义在于监听 XMLHttpRequest 的状态 </strong></p><p>1、获取状态行（包括状态码&amp;状态信息）</p><p>2、获取响应头</p><p>3、响应主体</p><p>我们需要检测并判断响应头的MIME类型后确定使用request.responseText或者request.responseXML</p><h3><a name='header-c70' class='md-header-anchor '></a>1.3.3   API 详解</h3><p>xhr.open() 发起请求，可以是get、post方式</p><p>xhr.setRequestHeader() 设置请求头</p><p>xhr.send() 发送请求主体get方式使用xhr.send(null)</p><p>xhr.onreadystatechange = function () {} 监听响应状态</p><p>readstate 属性有五个状态：</p><ul><li>xhr.readyState = 0时，（未初始化）还没有调用send()方法</li><li>xhr.readyState = 1时，（载入）已调用send()方法，正在发送请求</li><li>xhr.readyState = 2时，（载入完成）send()方法执行完成，已经接收到全部响应内容</li><li>xhr.readyState = 3时，（交互）正在解析响应内容</li><li>xhr.readyState = 4时，（完成）响应内容解析完成，可以在客户端调用了</li></ul><p><code>不用记忆状态，只需要了解有状态变化这个概念</code></p><p>xhr.status表示响应码，如200</p><p>xhr.statusText表示响应信息，如OK</p><p>xhr.getAllResponseHeaders() 获取全部响应头信息</p><p>xhr.getResponseHeader(&#39;key&#39;) 获取指定头信息</p><p>xhr.responseText、xhr.responseXML都表示响应主体</p><p><strong>注GET和POST请求方式的差异（面试题）</strong></p><p>1、GET没有请求主体，使用xhr.send(null)</p><p>2、GET可以通过在请求URL上添加请求参数</p><p>3、POST可以通过xhr.send(&#39;name=itcast&amp;age=10&#39;)</p><p>4、POST需要设置</p><p>Content-type:application/x-www-form-urlencoded</p><p>5、GET大小限制约4K，POST则没有限制</p><p>问题？如何获取复杂数据呢？</p><h2><a name='header-c125' class='md-header-anchor '></a>1.4  XML extensible markup language</h2><p>XML是一种标记语言，很类似HTML，其宗旨是用来传输数据，具有自我描述性（固定的格式的数据）。</p><pre class="md-fences md-end-block" lang="xml"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0"encoding="utf-8" ?&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">//上面为整个文档的第一句,否则格式错误</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">root</span><span class="cm-tag cm-bracket">&gt;</span>//标签名称 以字母和下滑线开头,不能有空格,不能包含特殊字符,区分大小写</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">items</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-tab">    </span>//说明下面的内容需要描述为数组</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span>//描述数组中的具体的成员值</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span>./images/nav_1.png<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span>京东超市<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span>//描述数组中的具体的成员值</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span>./images/nav_2.png<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span>全球购物<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span>//描述数组中的具体的成员值</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span>./images/nav_3.png<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">src</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span>京东市场<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">text</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">item</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">items</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">root</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 506px;"></div></div></div></pre><p>利用xml模式</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//让异步对象发送异步请求</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//1.创建对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">xhr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">XMLHttpRequset</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//2.设置请求行</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-string">"post"</span>, <span class="cm-string">"./server/nav-json.php"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//3.设置请求头</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">setRequestHeader</span>(<span class="cm-string">"Content-Type"</span>,<span class="cm-string">"application/x-www-form-urlencoded"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//4.设置请求体</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">send</span>(<span class="cm-atom">null</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//让异步对象接收服务器响应数据: 两个条件: 服务器响应了  数据解析完了</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">onreadystatechangge</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">status</span> <span class="cm-operator">==</span> <span class="cm-number">200</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">xhr</span>.<span class="cm-property">readtState</span> <span class="cm-operator">==</span> <span class="cm-number">4</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//responseText: 接收普通字符串</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//responseXML: 专门用来接收服务器返回的xml数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//如果文件已{}来描述,那么Juin转换对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">xhr</span>.<span class="cm-property">responseXML</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//将获取到的数据生成动态的页面结构</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//1.获取饭后结果中的所有的item元素</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">item</span> <span class="cm-operator">=</span> <span class="cm-variable-2">result</span>.<span class="cm-property">querySeletorAll</span>(<span class="cm-string">"item"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">for</span>(<span class="cm-keyword">var</span> <span class="cm-def">i</span><span class="cm-operator">=</span><span class="cm-number">0</span>; <span class="cm-variable-2">i</span><span class="cm-operator">&lt;</span><span class="cm-variable-2">item</span>.<span class="cm-property">length</span>;<span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">src</span> <span class="cm-operator">=</span> <span class="cm-variable-2">item</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">querySelector</span>(<span class="cm-string">"src"</span>).<span class="cm-property">innerHTML</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">text</span> <span class="cm-operator">=</span> <span class="cm-variable-2">item</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">querySelector</span>(<span class="cm-string">"text"</span>).<span class="cm-property">innerHTML</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;li&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">'&lt;a href = "#"&gt;'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">'&lt;img src = "'</span><span class="cm-operator">+</span> <span class="cm-variable-2">src</span> <span class="cm-operator">+</span><span class="cm-string">'" alt=""&gt;'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;p&gt;'+ text +'&lt;/p&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;/a&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;/li&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"ul"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable">html</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 739px;"></div></div></div></pre><p>服务器端的代码</p><pre class="md-fences md-end-block" lang="php"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;?</span><span class="cm-variable">php</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//默认的返回的数据类型</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//header("Content-Type", "text/html;charset=utf-8"); <span class="cm-tab">   </span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//如果要返回数据为xml, naem标砖的响应头的写法为</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-builtin">header</span>(<span class="cm-string">"Content-Type"</span>, <span class="cm-string">"application/xml;charset=utf-8"</span>);<span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">echo</span> <span class="cm-builtin">file_get_contents</span>(<span class="cm-string">"../data/nav.xml"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">?&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><h3><a name='header-c135' class='md-header-anchor '></a>1.4.1   语法规则</h3><p>1、必须有一个根元素 </p><p>2、标签名称不可有空格、不可以数字或.开头、大小写敏感</p><p>3、不可交叉嵌套</p><p>4、属性双引号（浏览器自动修正成双引号了）</p><p>5、特殊符号要使用实体</p><p>6、注释和HTML一样</p><p>虽然可以描述和传输复杂数据，但是其解析过于复杂并且体积较大，所以实现开发已经很少使用了</p><h2><a name='header-c150' class='md-header-anchor '></a>1.5  JSON</h2><p>即 JavaScript Object Notation，另一种轻量级的文本数据交换格式，独立于语言。</p><h3><a name='header-c153' class='md-header-anchor '></a>1.5.1   语法规则</h3><p>1、数据在名称/值对中</p><p>2、数据由逗号分隔(最后一个健/值对不能带逗号)</p><p>3、花括号保存对象方括号保存数组</p><p>4、使用双引号 </p><h3><a name='header-c162' class='md-header-anchor '></a><a href=''>1.5.2   JSON</a>解析</h3><p>JSON数据在不同语言进行传输时，类型为字符串，不同的语言各自也都对应有解析方法，需要解析完成后才能读取</p><p>1、Javascript 解析方法</p><p>JSON对象   JSON.parse()、 JSON.stringify()；</p><p>2、PHP解析方法</p><p>json_encode()、json_decode()</p><p>总结：JSON体积小、解析方便且高效，在实际开发成为首选。</p><p>利用json存储的方式</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//让异步对象发送异步请求</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//1.创建对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">xhr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">XMLHttpRequset</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//2.设置请求行</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-string">"get"</span>, <span class="cm-string">"./server/nav-json.php"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//3.设置请求头: get不需要设置</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//3.设置请求体</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">send</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//让异步对象接收服务器响应数据: 两个条件: 服务器响应了  数据解析完了</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">onreadystatechangge</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">status</span> <span class="cm-operator">==</span> <span class="cm-number">200</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">xhr</span>.<span class="cm-property">readtState</span> <span class="cm-operator">==</span> <span class="cm-number">4</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">xhr</span>.<span class="cm-property">responseText</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//在js中通过JSON.parse方法将json格式的字符串转换为js数组或对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab">    </span><span class="cm-comment">//如果文件已[]来描述,那么Juin转换数组</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab">    </span><span class="cm-comment">//如果文件已{}来描述,那么Juin转换对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">data</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable-2">result</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">html</span> <span class="cm-operator">=</span> <span class="cm-string">""</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">for</span>(<span class="cm-keyword">var</span> <span class="cm-def">i</span><span class="cm-operator">=</span><span class="cm-number">0</span>; <span class="cm-variable-2">i</span><span class="cm-operator">&lt;</span><span class="cm-variable-2">data</span>.<span class="cm-property">length</span>;<span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;li&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">'&lt;a href = "#"&gt;'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">'&lt;img src = "'</span><span class="cm-operator">+</span><span class="cm-variable-2">data</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">src</span><span class="cm-operator">+</span><span class="cm-string">'" alt=""&gt;'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;p&gt;'+data[i].text+'&lt;/p&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;/a&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable-2">html</span> <span class="cm-operator">+=</span> <span class="cm-string">"&lt;/li&gt;"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"ul"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable-2">html</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 651px;"></div></div></div></pre><p> </p><h2><a name='header-c180' class='md-header-anchor '></a>1.6  封装AJAX工具函数</h2><p>为了提升我们的开发效率，我们自已将XMLHttpRequest封装成一个函数。</p><h2><a name='header-c183' class='md-header-anchor '></a>1.7  jQuery中的Ajax</h2><p>jQuery为我们提供了更强大的Ajax封装</p><p>$.ajax({}) 可配置方式发起Ajax请求</p><p>$.get() 以GET方式发起Ajax请求</p><p>$.post() 以POST方式发起Ajax请求</p><p>$(&#39;form&#39;).serialize()序列化表单（即格式化key=val&amp;key=val）</p><p>url 接口地址</p><p>type 请求方式</p><p>timeout 请求超时</p><p>dataType 服务器返回格式</p><p>data 发送请求数据</p><p>beforeSend:function () {} 请求发起前调用</p><p>success 成功响应后调用</p><p>error 错误响应时调用</p><p>complete 响应完成时调用（包括成功和失败）</p><p><strong>jQuery Ajax介绍</strong></p><p><strong><a href='http://www.w3school.com.cn/jquery/jquery_ref_ajax.asp' target='_blank' >http://www.w3school.com.cn/jquery/jquery_ref_ajax.asp</a></strong></p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre></div><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">type</span>:<span class="cm-string">'post'</span>, <span class="cm-comment">//请求方式</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">url</span>:<span class="cm-string">'./server/nav-json.php'</span>, <span class="cm-comment">//请求url</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">data</span>:{}, <span class="cm-comment">//请求需要传递的参数</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">timeout</span>: <span class="cm-number">3000</span>, <span class="cm-comment">//请求超时: 单位为毫秒,如果服务器的响应时间超过了指定的时间,请求失败</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">dataType</span>: <span class="cm-string">'json'</span>, <span class="cm-comment">//设置响应数据的格式 xml json text html script jsonp</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">beforeSend</span>: <span class="cm-keyword">function</span> () { <span class="cm-comment">//发送请求之后的回调,在这个回调之中我们可以进行求情之前的相关操作,如验证</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//输入内容, 实现验证</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//在这个回调中,如果返回return false,则本次请求停止</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">success</span>: <span class="cm-variable">render</span>, <span class="cm-comment">//render没有定义,是一个函数 //请求成功之后的回调</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">errot</span>: <span class="cm-keyword">function</span> (<span class="cm-variable">e</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-keyword">if</span> (<span class="cm-variable">e</span>.<span class="cm-variable">statusText</span> <span class="cm-operator">==</span> <span class="cm-string">""</span><span class="cm-variable">timeOut</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">alert</span>(<span class="cm-string">"请求超时请重试"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;">  },</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">complete</span>: <span class="cm-variable">funciton</span> () { <span class="cm-comment">//无论成功失败都执行的回调</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span>  </span></pre><pre class=""><span style="padding-right: 0.1px;">  } &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 496px;"></div></div></div></pre><p>jq中的get方法</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>.<span class="cm-property">get</span>(<span class="cm-string">'./server/nav-json.php'</span>,<span class="cm-variable">render</span>,<span class="cm-string">'json'</span>); </span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//$.get(url, data, success, datatype);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// url 请求传递的url</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// data 请求传递的数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// success: 成功后的回调</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// dataType: 你需要返回的数据类型 xml json</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><p>jq中的post方法</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>.<span class="cm-property">post</span>(<span class="cm-string">'./server/nav-json.php'</span>,<span class="cm-variable">render</span>,<span class="cm-string">'json'</span>); </span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//$.post(url, data, success, datatype);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// url 请求传递的url</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// data 请求传递的数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// success: 成功后的回调</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">// dataType: 你需要返回的数据类型 xml json</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><h2><a name='header-c223' class='md-header-anchor '></a>1.8  案例练习</h2><p>1、Loading状态</p><p>2、禁止重复提交</p><p>3、表单处理</p><p>4、数据验证</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//获取验证码</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//1.为按钮添加单击事件</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>(<span class="cm-string">".verify"</span>).<span class="cm-property">on</span>(<span class="cm-string">"click"</span>, <span class="cm-keyword">function</span>(){</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//判断本次请求是否正在进行,如果是 ,则当前操作不响应</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">$</span>(<span class="cm-string">".verify"</span>).<span class="cm-property">hasClass</span>(<span class="cm-string">"disabled"</span>)){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.收集手机号,向服务器发送获取验证码请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">phone</span> <span class="cm-operator">=</span> <span class="cm-variable">$</span>(<span class="cm-string">".mobile"</span>).<span class="cm-property">val</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">type</span>:<span class="cm-string">"get"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">url</span>:<span class="cm-string">"./server/getCode.php"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">data</span>: {<span class="cm-string cm-property">"phone"</span>:<span class="cm-variable-2">phone</span>},</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//发送请求钱的或调函数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">beforeSend</span>: <span class="cm-keyword">function</span> (){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//手机号是否符合标准</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">reg</span> <span class="cm-operator">=</span> <span class="cm-string-2">/^1\d{10}$/</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//test: 就是验证参数值是否与指定的正则表达式匹配</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable-2">reg</span>.<span class="cm-property">text</span>(<span class="cm-variable-2">phone</span>)){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">$</span>(<span class="cm-string">".tips &gt; p"</span>).<span class="cm-property">fadeIn</span>(<span class="cm-number">1000</span>).<span class="cm-property">delay</span>(<span class="cm-number">2000</span>).<span class="cm-property">fadeOut</span>(<span class="cm-number">1000</span>).<span class="cm-property">text</span>(<span class="cm-string">'请输入合法的手机号'</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">return</span> <span class="cm-atom">false</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//既然没有返回,那么就需要发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">$</span>(<span class="cm-string">".verify"</span>).<span class="cm-property">addClass</span>(<span class="cm-string">"disabled"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//倒计时</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">total</span> <span class="cm-operator">=</span> <span class="cm-number">5</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">timeerId</span> <span class="cm-operator">=</span> <span class="cm-variable">setInterval</span>(<span class="cm-variable">funciton</span>(){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable-2">total</span> <span class="cm-operator">--</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">$</span>(<span class="cm-string">".verify"</span>).<span class="cm-property">val</span>(<span class="cm-variable-2">total</span><span class="cm-operator">+</span><span class="cm-string">'秒后重新获取'</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">if</span>(<span class="cm-variable-2">total</span> <span class="cm-operator">&lt;</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">$</span>(<span class="cm-string">".verify"</span>).<span class="cm-property">val</span>(<span class="cm-string">'重新获取'</span>).<span class="cm-property">removeClass</span>(<span class="cm-string">"disabled"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">clearInterval</span>(<span class="cm-variable">timerId</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  },<span class="cm-number cm-property">1000</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">success</span>: <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">alert</span>(<span class="cm-variable">result</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=""><span style="padding-right: 0.1px;">  })</span></pre><pre class=""><span style="padding-right: 0.1px;">})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//验证码是否存在</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//1.添加事件 blur </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>(<span class="cm-string">".name"</span>).<span class="cm-property">on</span>(<span class="cm-string">"biur"</span>,<span class="cm-variable">funciton</span>(){</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.收集用户数据,发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-variable">name</span> <span class="cm-operator">=</span> <span class="cm-variable">$</span>(<span class="cm-string">".name"</span>).<span class="cm-property">val</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">type</span>:<span class="cm-string">'get'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">url</span>:<span class="cm-string">'./server/validateUsername.php'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">data</span>: {<span class="cm-string cm-property">"name"</span>, <span class="cm-property">name</span>},</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//设置返回值属性</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">dataType</span>:<span class="cm-string">"json"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">success</span>: <span class="cm-keyword">function</span> (<span class="cm-def">result</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">if</span> (<span class="cm-variable-2">result</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">result</span>.<span class="cm-property">code</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">$</span>(<span class="cm-string">".tips &gt; p"</span>).<span class="cm-property">text</span>(<span class="cm-variable-2">result</span>.<span class="cm-property">msg</span>).<span class="cm-property">fadeIn</span>(<span class="cm-number">1000</span>).<span class="cm-property">delay</span>(<span class="cm-number">2000</span>).<span class="cm-property">fadeOut</span>(<span class="cm-number">1000</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">  })</span></pre><pre class=""><span style="padding-right: 0.1px;">})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//实现注册功能</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//1.添加注册事件</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//2.收集用户数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//3.发起ajax请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//4.接收响应,给出提示</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>(<span class="cm-string">'.submit'</span>).<span class="cm-property">on</span>(<span class="cm-string">"click"</span>,<span class="cm-keyword">function</span>(){\</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//当前是否有注册操作正在进行,如果有则不再进行用户请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">$</span>(<span class="cm-string">".submit"</span>).<span class="cm-property">hasClass</span>(<span class="cm-string">"disabled"</span>)){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//可以通过将表单序列化的方式来收集用户数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//1.这个方法是jq的方法,所以需要使用jq对象来调用</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//2.这个方法可以将表单中所有的name属性的表单元素的值收集,生成key=value&amp;key=value..这种格式</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//3.在ajax中,支持两种格式的参数(1.对象 2.参数格式字符串)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">data</span> <span class="cm-operator">=</span> <span class="cm-variable">$</span>(<span class="cm-string">"#ajaxForm"</span>).<span class="cm-property">serialize</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">type</span>:<span class="cm-string">'post'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">url</span>:<span class="cm-string">'./server/register.php'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">data</span>:<span class="cm-variable-2">data</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">timeout</span>: <span class="cm-number">3000</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">dataType</span>:<span class="cm-string">'json'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">beforeSend</span>:<span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//用户输入的合法性检测</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-comment">//如果验证通过.开启节流阀,避免用户反复提交</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">$</span>(<span class="cm-string">".submit"</span>).<span class="cm-property">addClass</span>(<span class="cm-string">"disabled"</span>).<span class="cm-property">val</span>(<span class="cm-string">"正在注册"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">success</span>: <span class="cm-keyword">function</span> (<span class="cm-def">result</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-keyword">if</span>(<span class="cm-variable-2">result</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable-2">result</span>.<span class="cm-property">code</span> <span class="cm-operator">==</span> <span class="cm-number">1</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">$</span>(<span class="cm-string">".tips &gt; p"</span>).<span class="cm-property">text</span>(<span class="cm-variable-2">result</span>.<span class="cm-property">msg</span>).<span class="cm-property">fadeIn</span>(<span class="cm-number">1000</span>).<span class="cm-property">deplay</span>(<span class="cm-number">2000</span>).<span class="cm-property">fadeOut</span>(<span class="cm-number">1000</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-property">error</span>: <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">$</span>(<span class="cm-string">".tips &gt; p"</span>).<span class="cm-property">text</span>(<span class="cm-string">'注册失败'</span>).<span class="cm-property">fadeIn</span>(<span class="cm-number">1000</span>).<span class="cm-property">deplay</span>(<span class="cm-number">2000</span>).<span class="cm-property">fadeOut</span>(<span class="cm-number">1000</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">complete</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">$</span>(<span class="cm-string">".submit"</span>).<span class="cm-variable">removeClass</span>(<span class="cm-string">"disabled"</span>).<span class="cm-variable">val</span>(<span class="cm-string">"注册"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">  })</span></pre><pre class=""><span style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2240px;"></div></div></div></pre><h2><a name='header-c233' class='md-header-anchor '></a>1.9  接口化开发</h2><p>请求地址即所谓的接口，通常我们所说的接口化开发，其实是指一个接口对应一个功能，并且严格约束了请求参数和响应结果的格式，这样前后端在开发过程中，可以减少不必要的讨论，从而并行开发，可以极大的提升开发效率，另外一个好处，当网站进行改版后，服务端接口只需要进行微调。</p><h1><a name='header-c237' class='md-header-anchor '></a>第2章 模板引擎</h1><p>Js插件 template_native.js</p><p>作用：渲染数据时  代替 拼接字符串的操作 </p><p>音乐案例</p><pre class='md-fences mock-cm' style='display:block;position:relative'>$.ajax({
  url:&quot;./music.php&quot;,
  dataType:&#39;json&#39;,
  success: function (result) {
    var html = &quot;&quot;;
    for (var i=0; i&lt;result.length;i++) {
      html += &#39;&lt;tr&gt;&#39;;
      html += &#39;&lt;td&gt;result[i].title&lt;/td&gt;&#39;;
      html += &#39;&lt;td&gt;result[i].singer&lt;/td&gt;&#39;;
      html += &#39;&lt;td&gt;result[i].album&lt;/td&gt;&#39;;
      html += &#39;&lt;td&gt;&lt;audio src = &quot;MP3/&#39;+result[i].src+&#39;&quot; contrals&gt;&lt;/audio&gt;&lt;/td&gt;&#39;;
      html += &#39;&lt;td&gt;&#39;;
      html += &#39;&lt;a href=&quot;./edit.php?id=&#39;+result[i].id+&#39;&quot; class=&quot;btn btn-primary&quot;&gt;&lt;/a&gt;&#39;;
      html += &#39;&lt;a href=&quot;./delete.php?id=&#39;+result[i].id+&#39;&quot; class=&quot;btn btn-danger&quot;&gt;&lt;/a&gt;&#39;;
      html += &#39;&lt;/td&gt;&#39;;
      html += &#39;&lt;/tr&gt;&#39;;
    }
    $(&quot;toby&quot;).html(html);
  }
})</pre><h2><a name='header-c245' class='md-header-anchor '></a>2.1  流行模板引擎</h2><p><strong>BaiduTemplate</strong>：<a href='http://tangram.baidu.com/BaiduTemplate/' target='_blank' >http://tangram.baidu.com/BaiduTemplate/</a></p><p><strong>ArtTemplate</strong>：<a href='http://aui.github.io/art-template/zh-cn/' target='_blank' >http://aui.github.io/art-template/zh-cn/</a></p><p><a href='https://aui.github.io/art-template/' target='_blank' >https://aui.github.io/art-template/</a>
<strong>velocity.js</strong>：<a href='https://github.com/shepherdwind/velocity.js/' target='_blank' >https://github.com/shepherdwind/velocity.js/</a></p><p><strong>Handlebars</strong>：<a href='http://handlebarsjs.com/' target='_blank' >http://handlebarsjs.com/</a>
<a href='http://blog.jobbole.com/56689/' target='_blank' >http://blog.jobbole.com/56689/</a></p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;!</span><span class="cm-variable">DOCTYPE</span> <span class="cm-variable">html</span><span class="cm-operator">&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">html</span> <span class="cm-variable">lang</span><span class="cm-operator">=</span><span class="cm-string">"en"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">head</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">meta</span> <span class="cm-variable">charset</span><span class="cm-operator">=</span><span class="cm-string">"UTF-8"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">title</span><span class="cm-operator">&gt;</span><span class="cm-variable">Title</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/title&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;!--</span> <span class="cm-operator">&lt;</span><span class="cm-variable">link</span> <span class="cm-variable">rel</span><span class="cm-operator">=</span><span class="cm-string">"stylesheet"</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"./css/index.css"</span><span class="cm-operator">&gt;</span> <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">body</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">h2</span><span class="cm-operator">&gt;</span><span class="cm-variable">京东商城</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/h2&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">ul</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;!--</span> <span class="cm-operator">&lt;</span><span class="cm-variable">li</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">a</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"#"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"./images/nav_1.png"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">p</span><span class="cm-operator">&gt;</span><span class="cm-variable">京东超市</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/p&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/li&gt; --&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/ul&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;!--</span> <span class="cm-variable">我们一般会将模板内容创建script标签中</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">1.</span><span class="cm-variable">必须添加一个类型，原则上可以设置为任意的浏览器不支持的类型</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">2.</span><span class="cm-variable">行业规范。一般会将类型设置text</span><span class="cm-operator">/</span><span class="cm-variable">template</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">3.</span><span class="cm-variable">为当前script标签设置唯一id</span>,<span class="cm-variable">方便后期的获取</span> <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">type</span><span class="cm-operator">=</span><span class="cm-string">"text/template"</span> <span class="cm-variable">id</span><span class="cm-operator">=</span><span class="cm-string">"navTemp"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">li</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">a</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"#"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"&lt;%=src%&gt;"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">p</span><span class="cm-operator">&gt;&lt;%=</span><span class="cm-variable">text</span><span class="cm-operator">%&gt;&lt;</span><span class="cm-string-2">/p&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">script</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">// 数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-variable">obj</span> <span class="cm-operator">=</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"src"</span>:<span class="cm-string">"./images/nav_3.png"</span> ,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"text"</span>:<span class="cm-string">"京东市场"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">// 模板在哪里创建</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 1.不能将模板字符串内容直接添加页面结构中，因为它会被浏览器解析 渲染</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 2.也不能做成注释，因为我们后期需要获取到这个字符串值，做成注释就无法获取了</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 3.我们在script标签中创建</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 1.设置了text/template类型，浏览器不会进行解析</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 2.设置了id,方便后期的元素内容的获取。script本质上也是一个标签，所以可以通过dom的方式来获取里面的内容</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">// 模板如何创建</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 1.占位符可以采用&lt;%=属性名称-值%&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 2.占位符中的值的名称一定要参照数据的属性名称</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">// 如何替换</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 1.读取模板内容</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">str</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">"navTemp"</span>).<span class="cm-property">innerHTML</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">str</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// &lt;%=src%&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">reg</span> <span class="cm-operator">=</span> <span class="cm-string-2">/&lt;%=(\w+)%&gt;/</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// exec:如果能够匹配到内容，则返回数组，否则返回null</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// var match = reg.exec(str);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// console.log(match);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// // match[0]:&lt;%=src%&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// // match[1]:src</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// // 找到对象中对应名称的属性值</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// var src = obj[match[1]]; //./images/nav_3.png</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// console.log(src);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// // 进行模板内容字符串的替换</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// str = str.replace(match[0],src);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// console.log(str);</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">match</span> <span class="cm-operator">=</span> <span class="cm-atom">null</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">while</span>(<span class="cm-variable">match</span> <span class="cm-operator">=</span> <span class="cm-variable">reg</span>.<span class="cm-property">exec</span>(<span class="cm-variable">str</span>)){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">str</span> <span class="cm-operator">=</span> <span class="cm-variable">str</span>.<span class="cm-property">replace</span>(<span class="cm-variable">match</span>[<span class="cm-number">0</span>],<span class="cm-variable">obj</span>[<span class="cm-variable">match</span>[<span class="cm-number">1</span>]]);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">str</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"ul"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable">str</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/html&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1590px;"></div></div></div></pre><h2><a name='header-c257' class='md-header-anchor '></a>2.2  artTemplate</h2><p>简介: artTemplate是新一代的js模板引擎,它采用预编译方式让性能有了质的飞跃,并充分利用js引擎的特性,使得其性能无论在前段还是后端都有出色的表现.</p><ol start='' ><li><p>语法</p><ul><li><p>artTemplate原生的js模板语法</p><ol start='' ><li><p>引入插件<code>&lt;script src=&quot;template-native.js&quot;&gt;&lt;/script&gt;</code></p></li><li><p>逻辑表达式 <code>&lt;% 与 %&gt;符号包裹起来的语句则为模板的逻辑表达式</code></p></li><li><p>输出表达式(编码可以防止数据中含有HTML字符串,避免xss攻击)</p><ul><li>对内容输出: &lt;%=content%&gt;</li><li>不编码输出: &lt;%=#content%&gt;</li></ul></li><li><p>实例:</p><pre class='md-fences mock-cm' style='display:block;position:relative'>&lt;h1&gt;&lt;%=value%&gt;&lt;/h1&gt;
&lt;ul&gt;
	&lt;%for(i=0; i&lt;arr.length;i++){%&gt;
		&lt;li&gt;数组元素的内容&lt;%=i + 1%&gt;: &lt;%=arr[i]%&gt;&lt;/li&gt;
	&lt;%}%&gt;
&lt;/ul&gt;</pre></li></ol></li><li><p>artTemplate简介语法</p><ol start='' ><li><p>引入插件<code>&lt;script src=&quot;template.js&quot;&gt;&lt;/script&gt;</code></p></li><li><p>逻辑表达式 <code>{{ 与 }}符号包裹起来的语句则为模板的逻辑表达式</code></p></li><li><p>输出表达式(编码可以防止数据中含有HTML字符串,避免xss攻击)</p><ul><li>对内容输出: {{content}}</li><li>不编码输出: {{#content}}</li></ul></li><li><p>条件表达式</p><pre class="md-fences md-end-block" lang="javascript"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-keyword">if</span> <span class="cm-variable">条件</span>}}</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">p</span><span class="cm-operator">&gt;</span><span class="cm-variable">内容</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/p&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-keyword">else</span> <span class="cm-keyword">if</span> <span class="cm-variable">value</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">p</span><span class="cm-operator">&gt;</span><span class="cm-variable">内容</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/p&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-keyword">else</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">p</span><span class="cm-operator">&gt;</span><span class="cm-variable">内容</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/p&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-string-2">/if}}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 159px;"></div></div></div></pre></li><li><p>循环遍历表达式: 无论数组或者对象都可以用each方法遍历</p><pre class="md-fences md-end-block" lang="javascript"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-variable">each</span> <span class="cm-variable">list</span> <span class="cm-variable">as</span> <span class="cm-variable">value</span> <span class="cm-variable">index</span>}}</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">li</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">index</span>}} <span class="cm-operator">-</span> {{<span class="cm-variable">value</span>.<span class="cm-variable">user</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-string-2">/each}}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//也可以简写为</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-variable">each</span> <span class="cm-variable">list</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">li</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">$index</span>}} <span class="cm-operator">-</span> {{<span class="cm-variable">$value</span>.<span class="cm-variable">user</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">{{<span class="cm-string-2">/each}}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 158px;"></div></div></div></pre></li><li><p>原版资料</p><pre class='md-fences mock-cm' style='display:block;position:relative'>Js代码包含在{{ }}中

{{data.key}}

{{data[&#39;key&#39;]}}

{{a ? b : c}}

   循环遍历：

{{each target   }}

   {{index}} {{value}}

{{/each}}</pre></li></ol></li></ul></li></ol><p>案例:</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">type</span><span class="cm-operator">=</span><span class="cm-string">"text/template"</span> <span class="cm-variable">id</span><span class="cm-operator">=</span><span class="cm-string">"musicTemp"</span><span class="cm-operator">&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-variable">each</span> <span class="cm-variable">items</span> <span class="cm-variable">as</span> <span class="cm-variable">value</span> <span class="cm-variable">index</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-keyword">if</span> <span class="cm-variable">index</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">tr</span> <span class="cm-variable">bgcolor</span><span class="cm-operator">=</span><span class="cm-string">'red'</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-keyword">else</span> <span class="cm-keyword">if</span> <span class="cm-variable">index</span> <span class="cm-operator">==</span> <span class="cm-number">1</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">tr</span> <span class="cm-variable">bgcolor</span><span class="cm-operator">=</span><span class="cm-string">'green'</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-keyword">else</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">tr</span> <span class="cm-variable">bgcolor</span><span class="cm-operator">=</span><span class="cm-string">'blue'</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-string-2">/if}}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">items</span>[<span class="cm-variable">index</span>].<span class="cm-variable">title</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">value</span>.<span class="cm-variable">singer</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">value</span>.<span class="cm-variable">album</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">audio</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"{{value.src}}"</span> <span class="cm-variable">controls</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/audio&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">a</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"./edit.php?id={{value.id}}"</span> <span class="cm-keyword">class</span><span class="cm-operator">=</span><span class="cm-string">"btn btn-primary"</span><span class="cm-operator">&gt;</span><span class="cm-variable">编辑</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">a</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"./delete.php?id={{value.id}}"</span> <span class="cm-keyword">class</span><span class="cm-operator">=</span><span class="cm-string">"btn btn-danger"</span><span class="cm-operator">&gt;</span><span class="cm-variable">删除</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-string-2">/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span>{{<span class="cm-string-2">/each}}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"./js/jquery.min.js"</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"./js/template.js"</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-variable">script</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 发送ajax请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">url</span>: <span class="cm-string">"./music.php"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">dataType</span>: <span class="cm-string">'json'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-property">success</span>: <span class="cm-keyword">function</span> (<span class="cm-def">result</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 调用模板引擎动态生成页面结构</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 如果参数是对象是直接传入对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 如果参数是数组，就包装为对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">html</span> <span class="cm-operator">=</span> <span class="cm-variable">template</span>(<span class="cm-string">"musicTemp"</span>,{<span class="cm-string cm-property">"items"</span>:<span class="cm-variable-2">result</span>});</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable">$</span>(<span class="cm-string">"tbody"</span>).<span class="cm-property">html</span>(<span class="cm-variable-2">html</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span>});</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 881px;"></div></div></div></pre><h1><a name='header-c324' class='md-header-anchor '></a>第3章 同源&amp;跨域</h1><h2><a name='header-c325' class='md-header-anchor '></a>3.1  同源</h2><p>同源策略是浏览器的一种安全策略，所谓同源是指，域名，协议，端口完全相同。</p><p><a href='http://www.jd.com---%253ewww.taobao.com'>www.jd.com---&gt;www.taobao.com</a></p><p><a href='http://www.taobaol.com'>www.taobaol.com</a></p><p>M.taobao.com  <a href='www.zfb.com' target='_blank' >www.zfb.com</a></p><p> </p><h2><a name='header-c336' class='md-header-anchor '></a>3.2  跨域</h2><p>不同源则跨域</p><p>1-不允许进行DOM操作</p><p>2-不能进行ajax请求</p><p>例如<a href='http://www.example.com/' target='_blank' >http://www.example.com/</a></p><table><thead><tr><th><a href='http://api.example.com/detail.html' target='_blank' >http://api.example.com/detail.html</a></th><th>不同源</th><th>域名不同</th></tr></thead><tbody><tr><td>https//<a href='www.example.com/detail.html' target='_blank' >www.example.com/detail.html</a></td><td>不同源</td><td>协议不同</td></tr><tr><td><a href='http://www.example.com:8080/detail.html' target='_blank' >http://www.example.com:8080/detail.html</a></td><td>不同源</td><td>端口不同</td></tr><tr><td><a href='http://api.example.com:8080/detail.html' target='_blank' >http://api.example.com:8080/detail.html</a></td><td>不同源</td><td>域名、端口不同</td></tr><tr><td><a href='https://api.example.com/detail.html' target='_blank' >https://api.example.com/detail.html</a></td><td>不同源</td><td>协议、域名不同</td></tr><tr><td><a href='https://www.example.com:8080/detail.html' target='_blank' >https://www.example.com:8080/detail.html</a></td><td>不同源</td><td>端口、协议不同</td></tr><tr><td><a href='http://www.example.com/detail/index.html' target='_blank' >http://www.example.com/detail/index.html</a></td><td>同源</td><td>只是目录不同</td></tr></tbody></table><h2><a name='header-c374' class='md-header-anchor '></a>3.3  跨域方案</h2><p>1、顶级域名相同的可以通过domain.name来解决，即同时设置 domain.name = 顶级域名（如example.com）</p><p>2、document.domain+ iframe</p><p>3、window.name+ iframe</p><p>4、location.hash+ iframe</p><p>5、window.postMessage()</p><p><strong>参考资料</strong></p><p><strong><a href='http://rickgray.me/2015/09/03/solutions-to-cross-domain-in-browser.html' target='_blank' >http://rickgray.me/2015/09/03/solutions-to-cross-domain-in-browser.html</a></strong></p><p>以上几种解决方案多数只能在某一特定情形下使用，兼容性及通用性都不够好，更通用的是JSONP解决方案。**</p><h2><a name='header-c391' class='md-header-anchor '></a>3.4  JSONP</h2><p>JSON with Padding</p><p><strong>1</strong>、原理剖析`</p><p>其本质是利用了<script src=""></script>标签具有可跨域的特性，由服务端返回一个预先定义好的Javascript函数的调用，并且将服务器数据以该函数参数的形式传递过来，此方法需要前后端配合完成。</p><p>只能以GET方式请求</p><p>案例01:</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//前段ajax中的jsonp请求</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">type</span>:<span class="cm-string">'get'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">url</span>:<span class="cm-string">'http://day08.com/getnav.php'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">dataType</span>:<span class="cm-string">"jsonp"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//需要后端语言配合</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-property">success</span>: <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">html</span> <span class="cm-operator">=</span> <span class="cm-variable">template</span>(<span class="cm-string">"navTemp"</span>, {<span class="cm-string cm-property">"item"</span>}:<span class="cm-variable">result</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"ul"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable-2">html</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 246px;"></div></div></div></pre><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//后台php操作 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;?</span><span class="cm-variable">php</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//设置跨域请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//*代表允许所有其他的域向当前域发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//header( 'Access-Control-Allow-Origin:*' ); </span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//设置允许指定的域发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//header( 'Access-Control-Allow-Origin:http://day09.com' );</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  </span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//这就是请求时所传递过来的函数名称</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-variable">$callback</span> <span class="cm-operator">=</span> <span class="cm-variable">$_GET</span>[<span class="cm-string">"callback"</span>]; <span class="cm-comment">//abc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//读取数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable">$data</span> <span class="cm-operator">=</span> <span class="cm-variable">file_get_contents</span>(<span class="cm-string">"nav.json"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//返回调用函数的形式, 只不过在这个形式中要传递前台需要的数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//说白了,后台在拼接字符串</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable">echo</span> <span class="cm-variable">$callback</span>.<span class="cm-string">'('</span>.<span class="cm-property">$data</span>.<span class="cm-string">')'</span>; <span class="cm-comment">//abc()</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">?&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p>案例2:</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//跨域中的jsonp使用</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;!</span><span class="cm-variable">DOCTYPE</span> <span class="cm-variable">html</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">html</span> <span class="cm-variable">lang</span><span class="cm-operator">=</span><span class="cm-string">"en"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">head</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">meta</span> <span class="cm-variable">charset</span><span class="cm-operator">=</span><span class="cm-string">"UTF-8"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">meta</span> <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"viewport"</span> <span class="cm-variable">content</span><span class="cm-operator">=</span><span class="cm-string">"width=device-width, initial-scale=1.0"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">meta</span> <span class="cm-variable">http</span><span class="cm-operator">-</span><span class="cm-variable">equiv</span><span class="cm-operator">=</span><span class="cm-string">"X-UA-Compatible"</span> <span class="cm-variable">content</span><span class="cm-operator">=</span><span class="cm-string">"ie=edge"</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">title</span><span class="cm-operator">&gt;</span><span class="cm-variable">Document</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/title&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">body</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;!--</span> <span class="cm-variable">实现跨域请求：请求数据</span>(<span class="cm-variable">服务器</span>) <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-operator">&lt;!--</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">下面这两个属性有天然的跨域特性</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">href</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">src</span>: <span class="cm-variable">img</span> <span class="cm-variable">script</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;!--</span> <span class="cm-operator">&lt;</span><span class="cm-variable">a</span> <span class="cm-variable">href</span><span class="cm-operator">=</span><span class="cm-string">"http://www.baidu.com"</span><span class="cm-operator">&gt;</span><span class="cm-variable">我的百度</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1105037253,1131367531&amp;fm=27&amp;gp=0.jpg"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;</span> <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;!--</span> <span class="cm-variable">下面我们利用script标签的src的天然的跨域特性来实现跨域操作</span> <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">script</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-keyword">function</span> <span class="cm-def">test</span>(<span class="cm-def">data</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">data</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;!--</span> <span class="cm-variable">因为我们是使用script来发送请求的，所以返回值默认会以script所支持js请求来解析</span>  <span class="cm-operator">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"http://day8.com/corss.php?callback=test"</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/html&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 672px;"></div></div></div></pre><pre class="md-fences md-end-block" lang="php"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//后台php操作 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;?</span><span class="cm-variable">php</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-comment">//接收用户传递的函数名称</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tab">  </span><span class="cm-variable-2">$callback</span> <span class="cm-operator">=</span> <span class="cm-variable-2">$_GET</span>[<span class="cm-string">"callback"</span>]; <span class="cm-comment">//abc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable-2">$data</span> <span class="cm-operator">=</span> <span class="cm-builtin">file_get_contents</span>(<span class="cm-string">"nav.json"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable-2">$data</span> <span class="cm-operator">=</span> <span class="cm-variable">json_encode</span>(<span class="cm-variable-2">$arr</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//返回的数据最终只能是字符串</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">echo</span> <span class="cm-variable-2">$callback</span>.<span class="cm-string">'('</span>.<span class="cm-variable-2">$data</span>.<span class="cm-string">')'</span>; <span class="cm-comment">//abc()</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">?&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><h2><a name='header-c408' class='md-header-anchor '></a>3.5  jQuery中的JSONP</h2><p>jQuery 的$.ajax() 方法当中集成了JSONP的实现，可以非常方便的实现跨域数据的访问。</p><p>dataType:&#39;jsonp&#39; 设置dataType值为jsonp即开启跨域访问</p><p>jsonp 可以指定服务端接收的参数的“key”值，默认为callback</p><p>jsonpCallback 可以指定相应的回调函数，默认自动生成</p><p><code>自己封装jQuery中的jsonp</code></p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">script</span><span class="cm-operator">&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">function</span> <span class="cm-def">text</span> (<span class="cm-def">result</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">result</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  };</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//定义自己的ajax</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">var</span> <span class="cm-def">$</span> <span class="cm-operator">=</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-property">ajax</span>:<span class="cm-keyword">function</span>(<span class="cm-def">option</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">url</span> <span class="cm-operator">=</span> <span class="cm-variable-2">option</span>.<span class="cm-property">url</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">callback</span> <span class="cm-operator">=</span> <span class="cm-variable-2">option</span>.<span class="cm-property">callback</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">dataType</span> <span class="cm-operator">=</span> <span class="cm-variable-2">option</span>.<span class="cm-property">dataType</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">//当dataType为jsonp的时候我们需要发去一个跨域请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">if</span>(<span class="cm-variable-2">dataType</span> <span class="cm-operator">==</span> <span class="cm-string">""</span><span class="cm-variable">jsonp</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">//1.创建一个script标签</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">script</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">createElement</span>(<span class="cm-string">"script"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">//2.为script标签设置src属性,同时src中传入之后需要挨靠的函数名称</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable-2">script</span>.<span class="cm-property">src</span> <span class="cm-operator">=</span> <span class="cm-variable-2">url</span> <span class="cm-operator">+</span> <span class="cm-string">"?callback="</span><span class="cm-operator">+</span><span class="cm-variable-2">callback</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">//3.将生成的script标签添加到页面结构中</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable-2">script</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>};</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//自己通过$.ajax的方式发送请求,当我传入dataType:jsonp的时候,希望能够发送一个跨域请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-property">type</span>:<span class="cm-string">'get'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-property">url</span>:<span class="cm-string">'http://day08.com/corss.php'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-property">callback</span>:<span class="cm-string">'text'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-property">dataType</span>:<span class="cm-string">"jsonp"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>});</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//主要利用了script标签的天然的跨域特性来发送请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//它的实现方式:在发送请求时候传递一个函数名称给后台,后台返回数据的时候回返回这个函数的调用形式,并且在()实现拼接</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//ajax和jsop的本质不一样.ajax的核心是通过XMLHttpRequest来发送请求,而jsonp是通过script标签来实现请求的发送</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 722px;"></div></div></div></pre><h2><a name='header-c420' class='md-header-anchor '></a>3.6  服务器端跨域 CORS跨域：</h2><p>header( &#39;Access-Control-Allow-Origin:*&#39; ); </p><p>header( &#39;Access-Control-Allow-Origin:<a href='http://www.study.com' target='_blank' >http://www.study.com</a>&#39;);</p><p><strong>案例练习:jsonp跨域请求天气案例</strong></p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">table</span> <span class="cm-variable">border</span><span class="cm-operator">=</span><span class="cm-string">"1"</span><span class="cm-operator">&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">thead</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">tr</span><span class="cm-operator">&gt;</span> &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">date</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">dayPictureUrl</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">nightPictureUrl</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">temperature</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">weather</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">th</span><span class="cm-operator">&gt;</span><span class="cm-variable">wind</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/th&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/thead&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">tbody</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;!--</span> <span class="cm-operator">&lt;</span><span class="cm-variable">tr</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span><span class="cm-variable">周六</span> <span class="cm-number">03</span><span class="cm-variable">月31日</span> (<span class="cm-variable">实时：12℃</span>)<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"http://api.map.baidu.com/images/weather/day/yin.png"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"http://api.map.baidu.com/images/weather/night/duoyun.png"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span><span class="cm-number">17</span> <span class="cm-operator">~</span> <span class="cm-number">8</span><span class="cm-variable">℃</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span><span class="cm-variable">阴转多云</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span><span class="cm-variable">南风微风</span><span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/tr&gt; --&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/tbody&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-operator">&lt;</span><span class="cm-string-2">/table&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 493px;"></div></div></div></pre><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">type</span><span class="cm-operator">=</span><span class="cm-string">"text/template"</span> <span class="cm-variable">id</span><span class="cm-operator">=</span><span class="cm-string">"weatherTemp"</span><span class="cm-operator">&gt;</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> <span class="cm-operator">&lt;%</span> <span class="cm-keyword">for</span>(<span class="cm-keyword">var</span> <span class="cm-variable">i</span><span class="cm-operator">=</span><span class="cm-number">0</span>;<span class="cm-variable">i</span><span class="cm-operator">&lt;</span><span class="cm-variable">items</span>.<span class="cm-variable">length</span>;<span class="cm-variable">i</span><span class="cm-operator">++</span>){ <span class="cm-operator">%&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">tr</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;%=</span><span class="cm-variable">items</span>[<span class="cm-variable">i</span>].<span class="cm-property">date</span><span class="cm-operator">%&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"&lt;%=items[i].dayPictureUrl%&gt;"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"&lt;%=items[i].nightPictureUrl%&gt;"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;%=</span><span class="cm-variable">items</span>[<span class="cm-variable">i</span>].<span class="cm-property">temperature</span><span class="cm-operator">%&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;%=</span><span class="cm-variable">items</span>[<span class="cm-variable">i</span>].<span class="cm-property">weather</span><span class="cm-operator">%&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;%=</span><span class="cm-variable">items</span>[<span class="cm-variable">i</span>].<span class="cm-property">wind</span><span class="cm-operator">%&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-operator">&lt;%</span> }<span class="cm-operator">%&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; {{<span class="cm-variable">each</span> <span class="cm-variable">items</span> <span class="cm-variable">as</span> <span class="cm-variable">value</span> <span class="cm-variable">index</span>}}</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">tr</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">items</span>[<span class="cm-variable">index</span>].<span class="cm-variable">date</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"{{items[index].dayPictureUrl}}"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;&lt;</span><span class="cm-variable">img</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"{{items[index].nightPictureUrl}}"</span> <span class="cm-variable">alt</span><span class="cm-operator">=</span><span class="cm-string">""</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">items</span>[<span class="cm-variable">index</span>].<span class="cm-variable">temperature</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">items</span>[<span class="cm-variable">index</span>].<span class="cm-variable">weather</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-variable">td</span><span class="cm-operator">&gt;</span>{{<span class="cm-variable">items</span>[<span class="cm-variable">index</span>].<span class="cm-variable">wind</span>}}<span class="cm-operator">&lt;</span><span class="cm-string-2">/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-operator">&lt;</span><span class="cm-string-2">/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  {{<span class="cm-string-2">/each}}</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"./js/jquery.min.js"</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-operator">&lt;</span><span class="cm-variable">script</span> <span class="cm-variable">src</span><span class="cm-operator">=</span><span class="cm-string">"./js/template-native.js"</span><span class="cm-operator">&gt;&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-operator">&lt;</span><span class="cm-variable">script</span><span class="cm-operator">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  <span class="cm-variable">$</span>.<span class="cm-property">ajax</span>({</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-property">type</span>:<span class="cm-string">'post'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-property">url</span>:<span class="cm-string">"http://api.map.baidu.com/telematics/v3/weather"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-property">data</span>:{</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"ak"</span>:<span class="cm-string">"zVo5SStav7IUiVON0kuCogecm87lonOj"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"location"</span>:<span class="cm-string">"北京"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"output"</span>:<span class="cm-string">'json'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  },</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-property">dataType</span>:<span class="cm-string">'jsonp'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// jsonpCallback:function(){}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-property">success</span>:<span class="cm-keyword">function</span>(<span class="cm-def">result</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">var</span> <span class="cm-def">html</span> <span class="cm-operator">=</span> <span class="cm-variable">template</span>(<span class="cm-string">"weatherTemp"</span>,{<span class="cm-string cm-property">"items"</span>:<span class="cm-variable-2">result</span>.<span class="cm-property">results</span>[<span class="cm-number">0</span>].<span class="cm-property">weather_data</span>});</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"tbody"</span>).<span class="cm-property">innerHTML</span> <span class="cm-operator">=</span> <span class="cm-variable-2">html</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp;  });</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-operator">&lt;</span><span class="cm-string-2">/script&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 919px;"></div></div></div></pre><p>天气接口：</p><p><a href='http://lbsyun.baidu.com/index.php?title=car/api/weather' target='_blank' >http://lbsyun.baidu.com/index.php?title=car/api/weather</a></p><p>天气预报的密钥：zVo5SStav7IUiVON0kuCogecm87lonOj</p><p>百度API：</p><p><a href='http://apistore.baidu.com/' target='_blank' >http://apistore.baidu.com/</a></p><p>密钥：</p><p>21f068f20fd5b7ca99c8908c1ae9f2bb</p><p> </p><p>图灵机器人：<a href='http://www.tuling123.com/register/index.jhtml' target='_blank' >http://www.tuling123.com/register/index.jhtml</a></p><h1><a name='header-c447' class='md-header-anchor '></a>第4章 XMLHttpRequest2.0</h1><p>技术总是在实践中不断更新的，XMLHttpRequest也不例外。</p><h2><a name='header-c450' class='md-header-anchor '></a>4.1  设置超时</h2><p>a)    设置超时 xhr.timeout</p><p>b)    监听超时事件 xhr.ontimeout = function () {// code}</p><p>当请求超时，此事件就会被触发</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置超时间</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">timeout</span> <span class="cm-operator">=</span> <span class="cm-number">3000</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//监听超时</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">ontimeout</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">alert</span>(<span class="cm-string">'请求超时'</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">};</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">xhr</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">XMLHttpRequest</span>();</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置请求行</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">open</span>(<span class="cm-string">"get"</span>, <span class="cm-string">"01-timeout.php"</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置请求头: get不需要设置</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置请求体</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">send</span>(<span class="cm-atom">null</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//设置超时</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">timeout</span> <span class="cm-operator">=</span> <span class="cm-number">2000</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">ontimeout</span> <span class="cm-operator">=</span> <span class="cm-variable">funciton</span>(<span class="cm-variable">e</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">e</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//接收响应</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">onreadystatechange</span> <span class="cm-operator">=</span> <span class="cm-variable">fucntion</span> () {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">if</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">status</span> <span class="cm-operator">==</span><span class="cm-number">200</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">xhr</span>.<span class="cm-property">readyState</span> <span class="cm-operator">==</span><span class="cm-number">4</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">alert</span>(<span class="cm-variable">xhr</span>.<span class="cm-property">responseText</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 426px;"></div></div></div></pre><h2><a name='header-c459' class='md-header-anchor '></a>4.2  FormData</h2><p>a)    提供了一个新的内建对象，可用于管理表单数据</p><p>b)    首先要获取一个表单元素form</p><p>c)    然后在实例化时 new FormData(form)，将表单元素form传进去</p><p>d)    会返回一个对象，此对象可以直接做为xhr.send(formData)的参数</p><p>e)    此时我们的数据就是以二进制形式传递了</p><p>f)     注意我们这里只能以post形式传递，浏览器会自动为我们设置一个合适的请求头</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><h2><a name='header-c473' class='md-header-anchor '></a>4.3  二进制</h2><p>a)    我们上传文件是以二进制形式传递的</p><p>b)    我们可以通过表单<input type=”file”>获取到一个文件对象</p><p>c)    然后file.files[0]可以获取文件信息</p><p>d)    然后再利用var formData = new FormData() 实例化</p><p>e)    然后再利用formData.append(‘upload’, file.files[0])将文件转成二进制</p><p>f)     最后将 formData 做为xhr.send(formData)的参数</p><p>见代码示例11-3.html 和 11-3.php</p><pre class='md-fences mock-cm' style='display:block;position:relative'></pre><h2><a name='header-c489' class='md-header-anchor '></a>4.4  上传进度</h2><p>a)    利用XMLHttpRequest我们可以实现文件的上传</p><p>b)    并且我们可以通过xhr.upload.onprogress = function (ev) {// code}，监听上传的进度</p><p>c)    这时我们上传的进度信息会保存在事件对象ev里</p><p>d)    ev.loaded 表示已上传的大小，ev.total表示文件整体的大小</p><p>e)    var percent = ev.loaded / ev.total</p><pre class="md-fences md-end-block" lang="js"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//监听上传的进度</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">xhr</span>.<span class="cm-property">upload</span>.<span class="cm-property">onprogress</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> (<span class="cm-def">ev</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">//事件对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-keyword">var</span> <span class="cm-def">percent</span> <span class="cm-operator">=</span> (<span class="cm-variable-2">ev</span>.<span class="cm-property">loaded</span> <span class="cm-operator">/</span> <span class="cm-variable-2">ev</span>.<span class="cm-property">total</span>) <span class="cm-operator">*</span> <span class="cm-number">100</span> <span class="cm-operator">+</span> <span class="cm-string">'%'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-variable">progress</span>.<span class="cm-property">style</span>.<span class="cm-property">width</span> <span class="cm-operator">=</span> <span class="cm-variable-2">percent</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> }</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><h2><a name='header-c501' class='md-header-anchor '></a>接口化开发</h2><p>请求地址即所谓的接口,通常我们所说的接口化开发,其实是指一个接口对应一个功能,并且严格约束了请求参数和参数结构的格式,这样前后端在开发过程中,可以减少不必要的讨论,从而进行开发,可以极大的提成效率,另外一个好处,当网站进行改版后,服务端接口只需要进行微调.</p></div>
</body>
</html>